#!/bin/bash

# Create CSV file
echo "Name,Height (m),Weight (kg)" > pokemon_report.csv

# Process each JSON file and create CSV
for file in pokemon_data/*.json; do
    if [ -f "$file" ]; then
        name=$(jq -r '.name' "$file" | sed 's/.*/\u&/')
        height=$(jq -r '.height' "$file")
        weight=$(jq -r '.weight' "$file")
        
        # Convert to proper units
        height_m=$(echo "scale=2; $height / 10" | bc)
        weight_kg=$(echo "scale=2; $weight / 10" | bc)
        
        echo "${name},${height_m},${weight_kg}" >> pokemon_report.csv
    fi
done

echo "CSV Report generated at: pokemon_report.csv"
echo ""
cat pokemon_report.csv
echo ""

# Use awk to calculate averages
awk -F',' '
NR>1 {
    total_height += $2
    total_weight += $3
    count++
}
END {
    if (count > 0) {
        avg_height = total_height / count
        avg_weight = total_weight / count
        printf "Average Height: %.2f m\n", avg_height
        printf "Average Weight: %.2f kg\n", avg_weight
    }
}' pokemon_report.csv
