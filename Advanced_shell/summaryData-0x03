#!/bin/bash

# Create CSV file
echo "Name,Height (m),Weight (kg)" > pokemon_report.csv

# Process each JSON file
total_height=0
total_weight=0
count=0

for file in pokemon_data/*.json; do
    if [ -f "$file" ]; then
        name=$(jq -r '.name' "$file" | sed 's/.*/\u&/')
        height=$(jq -r '.height' "$file")
        weight=$(jq -r '.weight' "$file")
        
        # Convert to proper units
        height_m=$(echo "scale=2; $height / 10" | bc)
        weight_kg=$(echo "scale=2; $weight / 10" | bc)
        
        echo "${name},${height_m},${weight_kg}" >> pokemon_report.csv
        
        # Add to totals for average calculation
        total_height=$(echo "$total_height + $height_m" | bc)
        total_weight=$(echo "$total_weight + $weight_kg" | bc)
        count=$((count + 1))
    fi
done

# Calculate averages
avg_height=$(echo "scale=2; $total_height / $count" | bc)
avg_weight=$(echo "scale=2; $total_weight / $count" | bc)

echo "CSV Report generated at: pokemon_report.csv"
echo ""
cat pokemon_report.csv
echo ""
echo "Average Height: $avg_height m"
echo "Average Weight: $avg_weight kg"
